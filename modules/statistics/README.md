# Statistics Module

–ú–æ–¥—É–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏ –±–æ—Ç–∞.

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ù–µ—Ç ‚Äî —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è–º.
–î–æ—Å—Ç—É–ø–µ–Ω –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (Dashboard) –∏ –±–æ—Ç–µ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤).

---

## –ú–µ—Ç—Ä–∏–∫–∏

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
| –ü–µ—Ä–∏–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| –í—Å–µ–≥–æ | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| –ó–∞ –¥–µ–Ω—å | –ù–æ–≤—ã—Ö –∑–∞ –≤—á–µ—Ä–∞ |
| –ó–∞ 7 –¥–Ω–µ–π | –ù–æ–≤—ã—Ö –∑–∞ –Ω–µ–¥–µ–ª—é |
| –ó–∞ 14 –¥–Ω–µ–π | –ù–æ–≤—ã—Ö –∑–∞ 2 –Ω–µ–¥–µ–ª–∏ |
| –ó–∞ –º–µ—Å—è—Ü | –ù–æ–≤—ã—Ö –∑–∞ 30 –¥–Ω–µ–π |

### –ê–∫—Ç–∏–≤–∞—Ü–∏–∏ (–ø—Ä–æ–º–æ–∫–æ–¥—ã)
| –ü–µ—Ä–∏–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| –í—Å–µ–≥–æ | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–π |
| –ó–∞ –¥–µ–Ω—å | –ê–∫—Ç–∏–≤–∞—Ü–∏–π –∑–∞ –≤—á–µ—Ä–∞ |
| –ó–∞ 7 –¥–Ω–µ–π | –ê–∫—Ç–∏–≤–∞—Ü–∏–π –∑–∞ –Ω–µ–¥–µ–ª—é |
| –ó–∞ 14 –¥–Ω–µ–π | –ê–∫—Ç–∏–≤–∞—Ü–∏–π –∑–∞ 2 –Ω–µ–¥–µ–ª–∏ |
| –ó–∞ –º–µ—Å—è—Ü | –ê–∫—Ç–∏–≤–∞—Ü–∏–π –∑–∞ 30 –¥–Ω–µ–π |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
| –ú–µ—Ç—Ä–∏–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| –ë–∏–ª–µ—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ | –°—É–º–º–∞ –≤—Å–µ—Ö –±–∏–ª–µ—Ç–æ–≤ |
| –ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–¥–æ–≤ | –ü—Ä–æ–º–æ–∫–æ–¥–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å |
| –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |

---

## –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (Dashboard)

```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1,234 –≤—Å–µ–≥–æ     ‚îÇ
‚îÇ +12 —Å–µ–≥–æ–¥–Ω—è     ‚îÇ
‚îÇ +89 –∑–∞ –Ω–µ–¥–µ–ª—é   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ê–∫—Ç–∏–≤–∞—Ü–∏–∏:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 567 –≤—Å–µ–≥–æ       ‚îÇ
‚îÇ +5 —Å–µ–≥–æ–¥–Ω—è      ‚îÇ
‚îÇ +42 –∑–∞ –Ω–µ–¥–µ–ª—é   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

[–ì—Ä–∞—Ñ–∏–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –∑–∞ 30 –¥–Ω–µ–π]
```

### –ë–æ—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

```
/stats

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞

üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
‚Ä¢ –í—Å–µ–≥–æ: 1,234
‚Ä¢ –°–µ–≥–æ–¥–Ω—è: +12
‚Ä¢ –ó–∞ 7 –¥–Ω–µ–π: +89
‚Ä¢ –ó–∞ 14 –¥–Ω–µ–π: +156
‚Ä¢ –ó–∞ –º–µ—Å—è—Ü: +312

üîë –ê–∫—Ç–∏–≤–∞—Ü–∏–∏:
‚Ä¢ –í—Å–µ–≥–æ: 567
‚Ä¢ –°–µ–≥–æ–¥–Ω—è: +5
‚Ä¢ –ó–∞ 7 –¥–Ω–µ–π: +42
‚Ä¢ –ó–∞ 14 –¥–Ω–µ–π: +78
‚Ä¢ –ó–∞ –º–µ—Å—è—Ü: +145

üéü –ë–∏–ª–µ—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ: 2,345
üì¶ –ö–æ–¥–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å: 433
```

---

## Handlers (–±–æ—Ç)

| Trigger | Handler | Description |
|---------|---------|-------------|
| `/stats` | `show_stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã) |

---

## API –¥–ª—è –ø–∞–Ω–µ–ª–∏

| Endpoint | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| `/api/stats/summary` | GET | –°–≤–æ–¥–∫–∞ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ |
| `/api/stats/users` | GET | –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `/api/stats/activations` | GET | –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–π |
| `/api/stats/chart/registrations` | GET | –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ |

---

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

```python
@cache(ttl=300)
async def get_stats_summary(bot_id: int):
    ...
```

---

## –°–æ–±—ã—Ç–∏—è

### –°–ª—É—à–∞–µ—Ç
- `registration.user_registered` ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—á—ë—Ç—á–∏–∫
- `promo.code_activated` ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—á—ë—Ç—á–∏–∫

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å get_status

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—â–µ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã:

```python
async def get_status(self, bot_id: int):
    return {
        **await super().get_status(bot_id),
        "metrics": {
            "users_total": await self.get_users_count(bot_id),
            "activations_today": await self.get_activations_today(bot_id)
        }
    }
```
