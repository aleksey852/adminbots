# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –∏ –¥–µ–ø–ª–æ—é (Production Guide)

–ó–¥–µ—Å—å –æ–ø–∏—Å–∞–Ω–æ, –∫–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å –±–æ—Ç–∞, –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –∏ –ø—Ä–∞–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–∏—á–µ–≥–æ –Ω–µ –ª–æ–º–∞–ª–æ—Å—å.

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ —É–∂–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –æ—á–µ–Ω—å –≥—Ä–∞–º–æ—Ç–Ω–æ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏:
*   **–ù–æ–≤—ã–µ –±–æ—Ç—ã**: –î–æ–±–∞–≤–ª—è—é—Ç—Å—è "–Ω–∞ –ª–µ—Ç—É" –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–Ω–µ–ª–∏. –°–∏—Å—Ç–µ–º–∞ —Å–ª—É—à–∞—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (`PG LISTEN/NOTIFY`) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã—Ö –±–æ—Ç–æ–≤.
*   **–ö–æ–Ω—Ñ–∏–≥–∏ –∏ —Ç–µ–∫—Å—Ç—ã**: –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É (—Å–æ–±—ã—Ç–∏–µ `reload_config`).
*   **–ö–æ–¥ (Python)**: –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞.

---

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è "–ë—ã—Å—Ç—Ä—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç" (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `scripts/update.sh`, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1.  –°–∫–∞—á–∏–≤–∞–µ—Ç –∫–æ–¥ (`git pull`).
2.  –û–±–Ω–æ–≤–ª—è–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`pip install`), –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.
3.  –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç **–æ–±–∞** —Å–µ—Ä–≤–∏—Å–∞: –∏ –±–æ—Ç–æ–≤ (`admin_bots`), –∏ –∞–¥–º–∏–Ω–∫—É (`admin_panel`).

**–ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å:**
```bash
sudo bash scripts/update.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞. –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.

---

## 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ë–î)

–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ ‚Äî –Ω–µ —Å–ª–æ–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

### –ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ: "–¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–π"
–ï—Å–ª–∏ –≤—ã –≤—ã–ø—É—Å–∫–∞–µ—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
*   ‚úÖ **–ú–æ–∂–Ω–æ**: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É, –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É.
*   ‚úÖ **–ú–æ–∂–Ω–æ**: –°–¥–µ–ª–∞—Ç—å –∫–æ–ª–æ–Ω–∫—É –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π (NULLABLE).
*   ‚ùå **–ù–µ–ª—å–∑—è**: –£–¥–∞–ª—è—Ç—å –∫–æ–ª–æ–Ω–∫–∏, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏ (–±–æ—Ç —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ —É–ø–∞–¥–µ—Ç, –ø–æ–∫–∞ –Ω–æ–≤–∞—è –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è).

### –ö–∞–∫ –Ω–∞–∫–∞—Ç—ã–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
–°–µ–π—á–∞—Å —Å—Ö–µ–º–∞ –ø–∞–Ω–µ–ª–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ `database/panel_db.py` -> `_create_panel_schema`. –û–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `IF NOT EXISTS`.

**–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `vip_status` –≤ —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
1.  –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –º–µ–Ω—è–π—Ç–µ —Å—Ç–∞—Ä—ã–π `CREATE TABLE` (–æ–Ω –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–±–ª–∏—Ü–∞ —É–∂–µ –µ—Å—Ç—å).
2.  –î–æ–±–∞–≤–ª—è–π—Ç–µ –±–ª–æ–∫ `DO $$ ... ALTER TABLE ... $$` (–∫–∞–∫ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è `manifest_path`):

```sql
DO $$ 
BEGIN
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns 
                   WHERE table_name='users' AND column_name='vip_status') THEN
        ALTER TABLE users ADD COLUMN vip_status BOOLEAN DEFAULT FALSE;
    END IF;
END $$;
```
–≠—Ç–æ—Ç –∫–æ–¥ –±–µ–∑–æ–ø–∞—Å–µ–Ω: –æ–Ω –¥–æ–±–∞–≤–∏—Ç –∫–æ–ª–æ–Ω–∫—É, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç, –∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç, –µ—Å–ª–∏ –æ–Ω–∞ —É–∂–µ –µ—Å—Ç—å.

---

## 4. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (Backup)

–ü–µ—Ä–µ–¥ –ª—é–±—ã–º –∫—Ä—É–ø–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –º–æ–¥—É–ª–µ–π –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø. –ü–æ—Å–∫–æ–ª—å–∫—É —É –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞ **—Å–≤–æ—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**, —ç—Ç–æ —Å–ø–∞—Å–∞–µ—Ç –æ—Ç –ø–æ–ª–Ω–æ–≥–æ –∫—Ä–∞—Ö–∞.

*   –ï—Å–ª–∏ —Å–ª–æ–º–∞–µ—Ç—Å—è –±–∞–∑–∞ –æ–¥–Ω–æ–≥–æ –±–æ—Ç–∞, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
*   –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø PostgreSQL (`pg_dump`) —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏.

## 5. –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫-–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è

1.  üõ† –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ.
2.  üíæ –°–¥–µ–ª–∞–ª–∏ –±—ç–∫–∞–ø (–µ—Å–ª–∏ –º–µ–Ω—è–µ—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î).
3.  üì• `git pull` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
4.  üîÑ `systemctl restart bot`.
5.  üëÄ –ü–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –ª–æ–≥–∏ (`journalctl -u bot -f`): –Ω–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞.

–í–∞—à–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –∏–∑–æ–ª—è—Ü–∏–µ–π –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (`per-bot db`) –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º (`scheduler.py`) ‚Äî —ç—Ç–æ —É–∂–µ —É—Ä–æ–≤–µ–Ω—å High Load —Ä–µ—à–µ–Ω–∏–π. –û–Ω–∞ –æ—á–µ–Ω—å —É—Å—Ç–æ–π—á–∏–≤–∞.
